#testing for pypoll code
# First we'll import the os module
# This will allow us to create file paths across operating systems
import os

# Module for reading CSV files
import csv
csvpath = os.path.join("..", "nu1to3", "PyPoll", "Resources", "election_data.csv")

#open the file as a csv file, and make the delimiter a comma and read it
with open(csvpath) as csvfile:
    csvreader = csv.reader(csvfile, delimiter=',')

#display the csv data
    print(csvreader)

# Now that it is displayed, read the header row first
    csv_header = next(csvreader)

#display the header
    print(f'CSV Header: {csv_header}')

#define variables I need calculated
    total_votes = 0

#for every candidate that there is, I need their name, vote count, and vote percentage
#therefore, I will need a loop to tally as the code runs through the list for every
# name it encounters the name and total votes. then at the end, I can calcuate their 
#percentages and who the winners are. this comes froma  list of potential canidates in column 3
    candidate_list = {}
    candidate_name = []
    candidate_votes = ""
    candidate_vote_percentage = ""

#now I need it to loop through each row and tally, adding 1 tot the votes total
#tracking the candidate name, and adding 1 vote to that candidate's total
for row in csvreader:
    total_votes += 1
    candidate_name = row [2]
    if candidate_name in candidate_list:
        candidate_list[candidate_name] += 1
    else:
        candidate_list[candidate_name] = 1

winning_candidate = max(candidate_list)

print("Election Results")
print("------------------------")
print("Total Votes: + {total_votes}")
print("------------------------")
voter_output = f"{candidate_name}: {candidate_vote_percentage: .3f}% ({candidate_votes})\n"
print(voter_output)
print("------------------------")
print("The winner is:  + {winning_candidate}")    
print("------------------------")

#put the following information into a new text file
output_file = os.path.join("election results.txt")

#override anything that is already in the file (using "w")
f = open("election results.txt", "w")
f.write("Election Results")
#skip a line--I found how to do this at https://stackoverflow.com/questions/2918362/writing-string-to-a-file-on-a-new-line-every-time
f.write("\n")
f.write("------------------------")
f.write("\n")
f.write("Total Votes: + {total_votes}")
f.write("\n")
f.write("------------------------")
f.write("\n")
voter_output = f"{candidate}: {vote_percentage: .3f}% ({votes})\n"
f.write("\n")
f.write("------------------------")
f.write("\n")
f.write("Winner: + {winning_candidate[winning_vote_count]}")
f.write("\n")
f.write("------------------------")
f.write("\n")

